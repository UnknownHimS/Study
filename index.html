<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8" />
  <title>Study Tool with Toolbar</title>
  <style>
    * {
      margin: 0; padding: 0; box-sizing: border-box;
    }
    body, html {
      height: 100%;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: url('https://images.unsplash.com/photo-1503264116251-35a269479413?auto=format&fit=crop&w=1950&q=80') no-repeat center center fixed;
      background-size: cover;
      overflow: hidden;
    }
    #app {
      display: flex;
      flex-direction: column;
      height: 100vh;
      padding: 10px;
      margin-right: 60px; /* leave space for sidebar */
    }
    #pdf-container {
      resize: vertical;
      overflow: auto;
      border: 2px solid #ccc;
      border-radius: 8px;
      min-height: 200px;
      max-height: 60vh;
      background: white;
    }
    embed {
      width: 100%;
      height: 100%;
      border-radius: 8px;
    }
    textarea {
      flex: 1;
      width: 100%;
      height: 200px;
      margin-top: 10px;
      border-radius: 8px;
      padding: 10px;
      font-size: 1em;
      background: rgba(255,255,255,0.9);
      border: none;
      resize: none;
    }

    #drawCanvas {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 1;
      pointer-events: none;
    }
    .drawing-enabled #drawCanvas {
      pointer-events: all;
    }

    /* Right sidebar */
    #sidebar {
      position: fixed;
      top: 10vh;
      right: 10px;
      width: 45px;
      background: rgba(255,255,255,0.9);
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 5px 0;
      z-index: 10;
      user-select: none;
    }
    #sidebar button {
      background: none;
      border: none;
      margin: 8px 0;
      cursor: pointer;
      width: 35px;
      height: 35px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 6px;
      transition: background-color 0.2s ease;
    }
    #sidebar button:hover, #sidebar button.active {
      background-color: #4caf50;
      color: white;
    }
    #sidebar button svg {
      width: 24px;
      height: 24px;
      pointer-events: none;
    }

    /* Uploaded images */
    img.uploaded-img {
      position: absolute;
      max-width: 200px;
      cursor: move;
      z-index: 4;
      user-select: none;
    }

    /* Timer (floating top-left) */
    #timer-btn {
      position: fixed;
      left: 20px;
      top: 20px;
      background-color: rgba(255,255,255,0.8);
      border: none;
      padding: 10px 15px;
      border-radius: 8px;
      cursor: pointer;
      z-index: 6;
    }
    #timer-popup {
      position: fixed;
      left: 20px;
      top: 70px;
      background: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      z-index: 6;
      display: none;
      width: 150px;
    }
    #timer-popup input {
      width: 50px;
      margin-right: 5px;
      text-align: center;
    }
    #timer-popup button {
      margin-top: 8px;
      width: 100%;
      padding: 5px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    #countdown-display {
      font-size: 1.2em;
      margin-top: 5px;
    }
  </style>
</head>
<body>

  <!-- Timer Button + Popup -->
  <button id="timer-btn">‚è± Timer</button>
  <div id="timer-popup">
    <label>Set Time (min):</label>
    <input type="number" id="minutes" value="20" min="1" />
    <div id="countdown-display">20:00</div>
    <button id="start-timer">Start</button>
    <button id="pause-timer">Pause</button>
    <button id="reset-timer">Reset</button>
  </div>

  <!-- Main app -->
  <div id="app">
    <div id="pdf-container">
      <embed id="pdfViewer" type="application/pdf" />
    </div>
    <textarea id="notes" placeholder="üìù Write your notes here..."></textarea>
  </div>

  <canvas id="drawCanvas"></canvas>

  <!-- Sidebar with icon buttons -->
  <div id="sidebar" title="Tools">
    <button id="btn-draw" title="Draw (Pencil)">
      <!-- Pencil icon -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" 
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 20h9" />
        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4 12.5-12.5z" />
      </svg>
    </button>
    <button id="btn-erase" title="Eraser">
      <!-- Eraser icon -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" 
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M16 16l4-4-8-8-4 4z" />
        <path d="M7 17l-3 3" />
        <path d="M14 10l-4 4" />
      </svg>
    </button>
    <button id="btn-img" title="Add Image from URL">
      <!-- Image icon -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" 
           stroke-linecap="round" stroke-linejoin="round">
        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
        <circle cx="8.5" cy="8.5" r="1.5"/>
        <path d="M21 15l-5-5L5 21"/>
      </svg>
    </button>
    <button id="btn-clear" title="Clear Drawing">
      <!-- Trash icon -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" 
           stroke-linecap="round" stroke-linejoin="round">
        <polyline points="3 6 5 6 21 6"/>
        <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
        <path d="M10 11v6"/>
        <path d="M14 11v6"/>
        <path d="M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
      </svg>
    </button>
    <button id="btn-pdf" title="Set PDF URL">
      <!-- PDF icon -->
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" 
           stroke-linecap="round" stroke-linejoin="round">
        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
        <polyline points="14 2 14 8 20 8"/>
        <line x1="16" y1="13" x2="8" y2="13"/>
        <line x1="16" y1="17" x2="8" y2="17"/>
        <line x1="10" y1="9" x2="8" y2="9"/>
      </svg>
    </button>
  </div>

<script>
  // PDF URL input prompt
  const pdfViewer = document.getElementById('pdfViewer');
  document.getElementById('btn-pdf').onclick = () => {
    const url = prompt("Enter PDF URL:");
    if (url) {
      pdfViewer.src = url;
    }
  };

  // Notes autosave
  const notes = document.getElementById('notes');
  notes.value = localStorage.getItem('study-notes') || '';
  notes.addEventListener('input', () => {
    localStorage.setItem('study-notes', notes.value);
  });

  // Timer code
  let timerInterval;
  let totalTime = 20 * 60;
  let isRunning = false;
  const timerPopup = document.getElementById('timer-popup');

  document.getElementById('timer-btn').addEventListener('click', () => {
    timerPopup.style.display = timerPopup.style.display === 'block' ? 'none' : 'block';
  });

  function updateTimerDisplay() {
    const mins = String(Math.floor(totalTime / 60)).padStart(2, '0');
    const secs = String(totalTime % 60).padStart(2, '0');
    document.getElementById('countdown-display').textContent = `${mins}:${secs}`;
  }

  function startTimer() {
    totalTime = parseInt(document.getElementById('minutes').value || "20") * 60;
    updateTimerDisplay();
    if (isRunning) return;
    isRunning = true;
    timerInterval = setInterval(() => {
      if (totalTime > 0) {
        totalTime--;
        updateTimerDisplay();
      } else {
        clearInterval(timerInterval);
        isRunning = false;
        alert("‚è∞ Time's up!");
      }
    }, 1000);
  }

  function pauseTimer() {
    clearInterval(timerInterval);
    isRunning = false;
  }

  function resetTimer() {
    pauseTimer();
    totalTime = parseInt(document.getElementById('minutes').value || "20") * 60;
    updateTimerDisplay();
  }

  document.getElementById('start-timer').onclick = startTimer;
  document.getElementById('pause-timer').onclick = pauseTimer;
  document.getElementById('reset-timer').onclick = resetTimer;

  updateTimerDisplay();

  // Drawing setup
  const canvas = document.getElementById("drawCanvas");
  const ctx = canvas.getContext("2d");
  let drawing = false;
  let erasing = false;
  let color = '#000000';

  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  window.addEventListener('resize', resizeCanvas);
  resizeCanvas();

  // Enable/disable drawing
  function enableDrawing(on) {
    if (on) {
      document.body.classList.add('drawing-enabled');
      canvas.style.zIndex = '5';
    } else {
      document.body.classList.remove('drawing-enabled');
      canvas.style.zIndex = '1';
    }
  }

  // Button states & logic
  const btnDraw = document.getElementById('btn-draw');
  const btnErase = document.getElementById('btn-erase');
  const btnClear = document.getElementById('btn-clear');
  const btnImg = document.getElementById('btn-img');

  function deactivateButtons() {
    [btnDraw, btnErase].forEach(btn => btn.classList.remove('active'));
    enableDrawing(false);
    erasing = false;
  }

  btnDraw.onclick = () => {
    if (btnDraw.classList.contains('active')) {
      deactivateButtons();
    } else {
      btnDraw.classList.add('active');
      btnErase.classList.remove('active');
      erasing = false;
      color = '#000000';
      enableDrawing(true);
    }
  };

  btnErase.onclick = () => {
    if (btnErase.classList.contains('active')) {
      deactivateButtons();
    } else {
      btnErase.classList.add('active');
      btnDraw.classList.remove('active');
      erasing = true;
      enableDrawing(true);
    }
  };

  btnClear.onclick = () => {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  };

  // Drawing events
  canvas.addEventListener("mousedown", e => {
    if (!document.body.classList.contains('drawing-enabled')) return;
    drawing = true;
    ctx.beginPath();
    ctx.moveTo(e.clientX, e.clientY);
  });

  canvas.addEventListener("mousemove", e => {
    if (!drawing) return;
    ctx.lineTo(e.clientX, e.clientY);
    ctx.strokeStyle = erasing ? "#ffffff" : color;
    ctx.lineWidth = erasing ? 30 : 2;
    ctx.lineCap = "round";
    ctx.stroke();
  });

  canvas.addEventListener("mouseup", () => drawing = false);
  canvas.addEventListener("mouseout", () => drawing = false);

  // Image URL upload and draggable images
  btnImg.onclick = () => {
    const url = prompt("Enter image URL:");
    if (!url) return;
    const img = document.createElement('img');
    img.src = url;
    img.className = 'uploaded-img';
    img.style.top = '150px';
    img.style.left = '150px';
    document.body.appendChild(img);

    // Dragging
    img.onmousedown = function (e) {
      e.preventDefault();
      let shiftX = e.clientX - img.getBoundingClientRect().left;
      let shiftY = e.clientY - img.getBoundingClientRect().top;
      function moveAt(pageX, pageY) {
        img.style.left = pageX - shiftX + 'px';
        img.style.top = pageY - shiftY + 'px';
      }
      function onMouseMove(e) {
        moveAt(e.pageX, e.pageY);
      }
      document.addEventListener('mousemove', onMouseMove);
      img.onmouseup = () => {
        document.removeEventListener('mousemove', onMouseMove);
        img.onmouseup = null;
      };
    };
    img.ondragstart = () => false;
  };
</script>

</body>
</html>
      function moveAt(pageX, pageY) {
        img.style.left = pageX - shiftX + 'px';
        img.style.top = pageY - shiftY + 'px';
      }
      function onMouseMove(e) {
        moveAt(e.pageX, e.pageY);
      }
      document.addEventListener('mousemove', onMouseMove);
      img.onmouseup = () => {
        document.removeEventListener('mousemove', onMouseMove);
        img.onmouseup = null;
      };
    };
    img.ondragstart = () => false;
  };
</script>

</body>
</html>
